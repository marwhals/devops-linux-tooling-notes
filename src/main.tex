%! Author = Marjan
%! Date = 02/02/2025
% Preamble
\documentclass[a4paper, 11pt]{book}

% Packages
\usepackage{amsmath}    % For math symbols and equations
\usepackage{graphicx}   % For including graphics
\usepackage{geometry}   % For adjusting page layout
\usepackage{fancyhdr}   % For custom headers/footers
\usepackage{hyperref}   % For hyperlinks
\usepackage{listings}   % For code listing
\usepackage{lipsum}     % For placeholder text (to test layout)
\usepackage{helvet} % Helvetica as a sans-serif font alternative\usepackage{xcolor}
\usepackage{enumitem} %Allow for lists

\renewcommand{\rmdefault}{phv} % Set the default font family to Helvetica

% Set page margins (A4 paper)
\geometry{top=1in, bottom=1in, left=1in, right=1in}

% Set up the header
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{Linux and Tooling notes}
\fancyhead[C]{Your Name}
\fancyhead[R]{\thepage}

% Document
\begin{document}
    % Title Page
    \begin{titlepage}
        \centering
        \vspace*{2in}
        \Huge \textbf{Linux and Tooling Notes}
        \vfill
        \Large -----
        \vfill
        \Large Date:% \today
    \end{titlepage}

% Table of Contents
    \tableofcontents
    \newpage


    \chapter{Linux}


    \section{Basic CLI}

    Notes on Linux, focus on the stuff beyond the basics.

    Everything is a file......

    \paragraph{What is a cgroup}

    \paragraph{Linux Processes - Orchestration of system operations}
    .........?

    \paragraph{Package managers}
    ....meh

    \paragraph{System boot process and systemd}

    \paragraph{Linux processes}

    \paragraph{Volumes partitions and mounts} - Managing file systems

    \paragraph{Logical volume manager}

    \paragraph{SSH}
    hmmmmmmm..........

    \paragraph{Firewalls, controlling network traffic}


    \section{Useful programs}
    systemmd
    systemctl - status --- show processes on the linux system


    \section{Notes about the file structure}


    \section{Bash}
    Reminders on Bash related things.......beyond standard programming constructs....

    \subsection{Bash CLI}
    Useful commands here

    \subsection{Bash Scripting}
    Hmmmmmm useful stuff for scripting


    \section{Hardening a Linux box}

    \subsection{Generally}
    Hardening a linux box

    \subsection{SELinux}


    \chapter{CI/CD stuff}


    \section{Git}

    Niche git commands


    \section{Docker}

    \paragraph{Motivations}
    Solves the problem of setting up environments for applications.

    \paragraph{Operating Systems, Hardware and the Kernel}
    Note: Some of these features are Linux specific......
    Note: Docker is a Linux virtual machine, inside this Linux VM is where the containers are running.
    This VM uses the Linux kernel, and it will be doing \textit{Linux} kernel things.

    Understanding what a Kernel is.
    Software process that acts as the middle guy between programs running on a computer and hardware resources.
    Programs interact with the kernel through system calls.
    Kernel exposes different system calls.
    Namespaces..segment hardware resources to different processes, control groups are another term, limit the CPU, RAM etc that a program can use.

    Namespacing (Linux specific) - Isolating resources per process (or group of processes) - Processes, Hard Drive, Network, Users, Hostnames, Inter Process Communication

    Control groups - Limit amount of processes used per process ---- Memory, CPU, HD I/O, Network Bandwith

    Container - a process or set or processes that have a grouping of resources specifically assigned to it

    Image - A file system snapshot of a very specific set of directories and files.
    Will also contain a specific startup command.

    Kernel will isolate a section of the hardrive/physical resource and make it avaiable only to this container.
    This container has access to this very specifc segment of the physical resources.

    \paragraph{Terminology}
    Docker is an overloaded term.
    Could be referring to Docker client, docker server, docker hub or docker compose.
    The goal of these tools is to create and run containers.

    \paragraph{Image}
    Single file with all the deps and config required to run a program.
    Containers are an instance of a program.

    \paragraph{Container}
    A program with its own isolated set of hardware resources. Consider kernel.

    \paragraph{Docker Client}
    Tool commands are issued to

    \paragraph{Docker Server}
    Tool that handles the docker related tasks such as creating images, running containers etc.
    Docker will check if a local image exists before downloading one from a central repository.


    \textbf{The Docker Ecosystem}

    \begin{itemize}[label=-]
        \item Docker Client - The CLI that interacts with the server
        \item Docker Server/Daemon - Background Server running on a machine
        \item Docker Machine - Used to manage docker environments
        \item Docker Images - The files used to create containers
        \item Docker Hub - A public repository for storing images
        \item Docker Compose - Useful for multi container environments, most applications will require different services.
    \end{itemize}


    \section{Docker commands}

    \subsubsection{Docker compose}


    \section{Kubernetes}

    \subsubsection{What is Kubernetes?}
    Clusters - A combination of a master node and multiple nodes.
    Node - A virtual machine which will run some number of containers, more than likely different.
    Each virtual machine can run different containers or different images, or different numbers of containers.
    All these different nodes are managed by the master node. Direction are given to the master node
    Load balancers are external to the cluster, routing requests.

    Use case, running many differnet containers with different images.

    \subsubsection{Usage}
    In a development environment use minikube
    In Prod \textit{managed solutions} are used via Cloud providers.
    Cloud providers would typically handle the low level details.
    DIY option does exist.

    Interact with minikube using KubeCtl.
    Manage the nodes with this tool.
    Only to be used in a local environment.

    \subsection{Docker compose vs Kubernetes}

    \begin{table}[h]
        \centering
        \begin{tabular}{|c|c |}
            \hline
            Docker Compose                                                 & Kubernetes                                        \\
            \hline
            Each entry can optionally get docker compose to build an image & Kubernetes expects all images to be already built \\
            Each entry represents a container we want to create            & One config file per object we want to create      \\
            Each entry defines the networking requirements (ports)         & We have to manually set up all networking         \\
            \hline
        \end{tabular}
        \caption{Sample Table}
        \label{tab:sample}
    \end{table}

    Kubernetes expects all docker images to be prebuilt. There is no build pipeline in kubernetst.
    Expectation is during some outside step these things will be built.

    \subsection{Deployment to a Kubernetes cluster}
    Make sure image is hosted on docker hub
    Make one config file to create the container
    Make one config file to create the container



    \section{Jenkins}

    \subsection{Manually using Jenkins}
    Hmmmm......

    Declarative pipeline vs Scripted Pipeline

    \subsection{Jenkins DSL}
    Create jobs using code.
    Requires Jenkins DSL plugin and the Groovy programming language.

    \paragraph{Seed Jobs}
    The jobs that creates all the other jobs on the server.

    \subsection{Jenkinsfiles}

    \paragraph{Pipeline}
    The workflow that is executed when going through the CI/CD process (or any other process).
    Jenkins as code a.k.a pipeline as code. Requires plugin to be installed

    \begin{lstlisting}[caption=Jenkinsfile for a CI/CD Pipeline]
pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo 'Building the application...' // Print message
            }
        }

        stage('Test') {
            steps {
                echo 'Running tests...'
            }
        }

        stage('Deploy') {
            steps {
                echo 'Deploying to production...'
            }
        }
    }

    post {
        success {
            echo 'Pipeline completed successfully!'
        }
        failure {
            echo 'Pipeline failed!'
        }
    }
}
    \end{lstlisting}


    \section{Kubernetes}

    \paragraph{What it is}
    A Master with one or more Nodes.
    Nodes are either virtual machines or a physical computer.
    Each of these machines can be used to run a different set of containers.
    Can be differnt images or different number of containers.
    These Nodes are managed by a Master node.
    Master node has a different set of programs running on it which can controdl what the nodes are running at a given time.
    The cluster is interacted with through the master.

    \paragraph{Why use kubernets} - Running different containers with different images....at scal


    \section{Ansible}
    Ansible for now. Need to consider chef and puppet


    \section{Terraform}
    Cloud stuff here


    \chapter{JVM Specific / Delete and or separate}


    \section{Maven}
    Maven stuff or keep separated


    \section{JVM details}
    Maybe include some low level JVM stuff here....or keep separate


    \chapter{Hmm maybe more, maybe delete}
    Other tools that can be used via a shell

    \paragraph{Code Example}


    \section{Code Example}
    \begin{lstlisting}[language=Java, caption=Java Code for a Simple Cache]
public class SimpleCache {
    private Map<String, String> cache = new HashMap<>();

    public String get(String key) {
        return cache.get(key);
    }

    public void put(String key, String value) {
        cache.put(key, value);
    }
}
    \end{lstlisting}

\end{document}
